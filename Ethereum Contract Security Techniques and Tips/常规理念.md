# 以太坊最佳实践

## 常规理念

以太坊和复杂的区块链编程是崭新的和高度实验性的。 因此，随着新 bug 和安全风险的发现，您应该预期到安全形势会不断发生变化，并制定新的最佳实践。 因此，遵循本文档中的安全措施只是作为智能合约开发人员需要做的安全工作的开始。

智能合约编程需要一个与您过往习惯不同的工程思维。失败的代价可能很高，并且更改可能很困难，使得它在某些方面更像硬件编程或金融服务编程，而不是 Web 或移动开发。因此，防御已知的漏洞是不够的。相反，你需要学习一种新的开发理念：

### 做好失败的准备

任何不平凡的（non-trivial）合约中都有错误。因此你的代码必须能够优雅地反馈 Bug 和漏洞。

* 当出现错误时暂停该合约（“电路中断者”） 
* 管理风险金额（限制比例，设置最大使用量）
* 为错误修正和改进提供有效的升级途径

### 小心地推出

在完整的产品发布前捕获错误总是更好。彻底地测试合约，并在每次发现新的攻击媒介时添加新的测试 - 从 alpha 测试网络起就提供 Bug 悬赏 - 随着每个阶段的使用和测试推出。

### 保持合约简单

复杂性增加错误的可能性。

* 确定合约的逻辑简单
* 通过模块化使得合约和函数小巧
* 在可以使用的地方使用已经存在的工具或者代码（比如，不要使用你自己写的随机数生成器）
* 只要有可能，请尽量保持清晰
* 只对你的系统中需要去中心化的部分使用区块链

### 保持更新

使用下一节中列出的资源跟踪新的安全开发。

* 检测你的合同是否有任何新发现的 bug
* 尽可能快的将工具或者类库更新到最新的版本
* 接受新的使用的安全技术

### 注意区块链的属性

虽然你的编程经验大部分将与以太坊编程相关，但有一些陷阱需要注意。
* 要非常小心外部合约的调用，这可能会执行恶意代码并更改控制流。
* 了解你的公共函数是公开的，可能会被恶意地调用。任何人都可以查看您的私人数据。
* 记住燃料的消耗和区块燃料的限制。

### 基本权衡：简单性与复杂性案例